services:
 php:
   build: ./php
   ports:
     - "8080:80" 
   volumes:
     - ./project:/var/www/html
   depends_on:
     - db
   environment:
     DB_HOST: db
     DB_PORT: 5432
     DB_NAME: ${DB_NAME}
     DB_USER: ${DB_USER}
     DB_PASSWORD: ${DB_PASSWORD}
   networks:
     - postgres

 db:
   image: postgres:latest
   ports:
     - "5432:5432"
   environment:
     POSTGRES_DB: ${DB_NAME}
     POSTGRES_USER: ${DB_USER}
     POSTGRES_PASSWORD: ${DB_PASSWORD}
   volumes:
     - postgres_data:/var/lib/postgresql/data
   networks:
     - postgres

 pgadmin:
   image: dpage/pgadmin4
   restart: always
   ports:
     - "5050:80"
   environment:
     PGADMIN_DEFAULT_EMAIL: ${PGADMIN_EMAIL}
     PGADMIN_DEFAULT_PASSWORD: ${PGADMIN_PASSWORD}
     PGADMIN_LISTEN_PORT: 80
   depends_on:
     - db
   networks:
     - postgres

networks:
 postgres:
   driver: bridge

volumes:
 postgres_data: